<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_purchase_order_custom">
        <t t-call="web.html_container">
            <meta charset="utf-8"/>
            <style>
                @page {
                    size: A4;
                    margin: 2mm;
                }
                .cell {
                    border: 0.6px solid #777;
                    padding: 6px;
                    vertical-align: top;
                    font-size: 16px;
                }

                .item-cell {
                    border-left: 0.6px solid #777;
                    border-right: 0.6px solid #777;
                    border-top: 0;
                    border-bottom: 0;
                    padding: 6px;
                }


                body {
                        font-size: 16px;
                        font-family: "DejaVu Sans", "Noto Sans", Arial, sans-serif;
                    }


                .center {
                    text-align: center;
                }
            </style>

            <t t-foreach="docs" t-as="o">

                <div style="position: relative; width:100%; height:287mm;">

                    <!-- HEADING -->
                    <div style="text-align:center;font-weight:bold;font-size:16px;margin-bottom:6mm;">
                        PURCHASE ORDER
                    </div>

                    <!-- PAGE BORDER -->
                    <div style="
                        position:absolute;
                        top:6mm; left:0; right:0; bottom:0;
                        border:0.7px solid #4c4b4b;
                        padding:6mm;
                        box-sizing:border-box;
                    ">

                        <!-- MASTER TABLE -->
                        <table style="width:100%; border-collapse:collapse;">

                            <tr>

                                <!-- ================= LEFT SIDE (55%) ================= -->
                                <td class="cell" style="width:55%; vertical-align:top; padding:0;">

                                <table style="width:100%; border-collapse:collapse;">

                                    <!-- INVOICE TO -->
                                    <tr>
                                        <td class="cell" style="border-left:none; border-right:none; border-top:none;">
                                            <table style="width:100%; border-collapse:collapse;">
                                                <tr>
                                                    <td style="width:18%;">
                                                        <img t-if="o.company_id.logo"
                                                            t-att-src="image_data_uri(o.company_id.logo)"
                                                            style="width:180px; height:auto;"/>
                                                    </td>
                                                    <td style="width:82%; padding-left:6px;">
                                                        Invoice To<br/>
                                                        <strong t-esc="o.company_id.name"/><br/>
                                                        <span t-esc="o.company_id.street"/><br/>
                                                        <span t-esc="o.company_id.city"/> -
                                                        <span t-esc="o.company_id.zip"/><br/>
                                                        GSTIN/UIN :
                                                        <span t-esc="o.company_id.vat"/><br/>
                                                        State Name :
                                                        <span t-esc="o.company_id.state_id.name"/>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>

                                    <!-- CONSIGNEE (SHIP TO) -->
                                    <tr>
                                        <td class="cell" style="border-left:none; border-right:none;">
                                            Consignee (Ship to)<br/>

                                            <strong t-esc="o.ship_to_name"/><br/>

                                            <t t-if="o.ship_to_street">
                                                <span t-esc="o.ship_to_street"/><br/>
                                            </t>

                                            <t t-if="o.ship_to_street2">
                                                <span t-esc="o.ship_to_street2"/><br/>
                                            </t>

                                            <t t-if="o.ship_to_city or o.ship_to_zip">
                                                <span t-esc="o.ship_to_city"/> - <span t-esc="o.ship_to_zip"/><br/>
                                            </t>

                                            <t t-if="o.ship_to_state_id">
                                                State Name: <span t-esc="o.ship_to_state_id.name"/><br/>
                                            </t>

                                            <t t-if="o.ship_to_gstin">
                                                GSTIN/UIN: <span t-esc="o.ship_to_gstin"/>
                                            </t>

                                        </td>
                                    </tr>


                                    <!-- SUPPLIER -->
                                    <tr>
                                        <td class="cell" style="border-left:none; border-right:none; border-bottom:none;">
                                            Supplier (Bill from)<br/>
                                            <strong t-esc="o.partner_id.name"/><br/>
                                            <span t-esc="o.partner_id.street"/><br/>
                                            GSTIN/UIN :
                                            <span t-esc="o.partner_id.vat"/><br/>
                                            State Name :
                                            <span t-esc="o.partner_id.state_id.name"/>
                                        </td>
                                    </tr>

                                </table>

                            </td>


                                <!-- ================= RIGHT SIDE (45%) ================= -->
                                <td class="cell" style="width:45%; vertical-align:top; padding:0;">

                                    <!-- HEADER GRID -->
                                    <table style="width:100%; border-collapse:collapse;">
                                        <tr>
                                            <td class="cell">
                                                Voucher No.<br/>
                                                <strong t-esc="o.name"/>
                                            </td>
                                            <td class="cell">
                                                Dated<br/>
                                                <strong t-esc="o.date_order.strftime('%d-%b-%Y')"/>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td class="cell"></td>
                                           <td class="cell">
                                                Mode / Terms of Payment<br/>
                                                <strong t-if="o.payment_term_id" t-esc="o.payment_term_id.name"/>
                                            </td>

                                        </tr>

                                        <tr>
                                            <td class="cell">
                                                Reference No. &amp; Date<br/>
                                                <strong t-esc="o.name"/>
                                            </td>
                                            <td class="cell">
                                                Other References<br/>
                                                <strong t-if="o.other_references" t-esc="o.other_references"/>
                                            </td>

                                        </tr>

                                        <tr>
                                            <td class="item-cell">
                                                Dispatched through<br/>
                                                <strong t-if="o.dispatched_through" t-esc="o.dispatched_through"/>
                                            </td>
                                            <td class="item-cell">
                                                Destination<br/>
                                                <strong t-if="o.destination" t-esc="o.destination"/>
                                            </td>
                                        </tr>


                                        <tr>
                                            <td colspan="2" style="
                                                border-bottom:0.6px solid #777;
                                                padding:0;
                                                height:0;
                                            "></td>
                                        </tr>

                                    </table>

                                    <!-- TERMS OF DELIVERY -->
                                    <div class="cell" style="border-top:0.6px solid #777;">
                                        Terms of Delivery<br/>
                                        <strong t-if="o.terms_of_delivery" t-esc="o.terms_of_delivery"/>
                                    </div>


                                </td>

                            </tr>

                        </table>

                        <!-- CALCULATE TAX AMOUNTS -->

                        <!-- GST CALCULATION (PURCHASE ORDER) -->
                        <t t-set="cgst_amount" t-value="0.0"/>
                        <t t-set="sgst_amount" t-value="0.0"/>
                        <t t-set="igst_amount" t-value="0.0"/>

                        <t t-foreach="o.order_line" t-as="line">
                            <t t-set="taxes"
                            t-value="line.taxes_id.compute_all(
                                            line.price_unit,
                                            o.currency_id,
                                            line.product_qty,
                                            product=line.product_id,
                                            partner=o.partner_id
                                        )"/>

                            <t t-foreach="taxes['taxes']" t-as="tax">
                                <t t-set="tax_name" t-value="(tax.get('name') or '').upper()"/>

                                <!-- CGST -->
                                <t t-if="'CGST' in tax_name">
                                    <t t-set="cgst_amount" t-value="cgst_amount + tax.get('amount', 0.0)"/>
                                </t>

                                <!-- SGST -->
                                <t t-if="'SGST' in tax_name">
                                    <t t-set="sgst_amount" t-value="sgst_amount + tax.get('amount', 0.0)"/>
                                </t>

                                <!-- IGST -->
                                <t t-if="'IGST' in tax_name">
                                    <t t-set="igst_amount" t-value="igst_amount + tax.get('amount', 0.0)"/>
                                </t>
                            </t>
                        </t>





                        <!-- ================= ITEMS TABLE ================= -->
                        <table style="width:100%; border-collapse:collapse; margin-top:0;">

                            <!-- HEADER -->
                            <tr>
                                <th class="cell center" style="width:5%;">Sl<br/>No.</th>
                                <th class="cell" style="width:45%;">Description of Goods</th>
                                <th class="cell center" style="width:12%;">Due on</th>
                                <th class="cell center" style="width:12%;">Quantity</th>
                                <th class="cell center" style="width:10%;">Rate</th>
                                <th class="cell center" style="width:6%;">per</th>
                                <th class="cell center" style="width:10%;">Amount</th>
                            </tr>

                            <!-- ROWS -->
                            <t t-set="slno" t-value="1"/>
                            <t t-foreach="o.order_line" t-as="line">
                                <tr>
                                    <!-- SL NO -->
                                    <td class="cell center">
                                        <t t-esc="slno"/>
                                        <t t-set="slno" t-value="slno + 1"/>
                                    </td>

                                    <!-- DESCRIPTION -->
                                    <td class="cell">
                                        <strong t-esc="line.name"/>
                                    </td>

                                    <!-- DUE DATE -->
                                    <td class="cell center">
                                        <t t-if="o.date_planned">
                                            <t t-esc="o.date_planned.strftime('%d-%b-%y')"/>
                                        </t>
                                    </td>

                                    <!-- QTY -->
                                    <td class="cell" style="text-align:right;">
                                        <strong>
                                            <t t-esc="line.product_qty"/>
                                        </strong>
                                        Nos.
                                    </td>

                                    <!-- RATE -->
                                    <td class="cell" style="text-align:right;">
                                        <t t-esc="line.price_unit"/>
                                    </td>

                                    <!-- PER -->
                                    <td class="cell center">
                                        Nos.
                                    </td>

                                    <!-- AMOUNT -->
                                    <td class="cell" style="text-align:right;">
                                        <t t-esc="line.price_subtotal"/>
                                    </td>
                                </tr>    
                            </t>


                            <tr>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>Total Amount</strong>
                                </td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>
                                        <span t-esc="o.amount_untaxed"
                                            t-options="{'widget':'monetary','display_currency':o.currency_id}"/>
                                    </strong>
                                </td>

                            </tr>


                            <tr>
                                <td class="cell" style="height:180px;"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                            </tr>

                            <tr>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;"><strong>CGST Input</strong></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <span t-esc="cgst_amount" t-options="{'widget':'monetary','display_currency':o.currency_id}"/>                                </td>
                            </tr>


                            <tr>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;"><strong>SGST Input</strong></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <span t-esc="sgst_amount" t-options="{'widget':'monetary','display_currency':o.currency_id}"/>
                                </td>
                            </tr>


                            <tr>
                            <td class="cell"></td>

                            <td class="cell" style="text-align:right;">
                                <strong>Round Off</strong>
                            </td>

                            <td class="cell"></td>
                            <td class="cell"></td>
                            <td class="cell"></td>
                            <td class="cell"></td>

                            <td class="cell" style="text-align:right;">
                                <strong>
                                <span t-esc="cgst_amount + sgst_amount" t-options="{'widget':'monetary','display_currency':o.currency_id}"/>                                </strong>
                            </td>
                        </tr>





                            <!-- TOTAL ROW -->
                            <tr>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;"><strong>Total Taxable Amount</strong></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>
                                        <t t-esc="sum(o.order_line.mapped('product_qty'))"/> Nos.
                                    </strong>
                                </td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>
                                        <span t-esc="o.amount_untaxed + cgst_amount + sgst_amount"
                                            t-options="{'widget':'monetary','display_currency':o.currency_id}"/>
                                    </strong>
                                </td>
                            </tr>


                        </table>


                        <!-- AMOUNT IN WORDS + E.&O.E + SIGNATURE (OUTER BORDER MATCHES SIGNATURE BOTTOM) -->
                        <table style="width:100%; border-collapse:collapse; margin-top:0;">

                            <!-- ROW 1 -->
                            <tr>
                                <td style="
                                    width:60%;
                                    vertical-align:top;
                                    border-top:0.6px solid #777;
                                    border-left:0.6px solid #777;
                                    border-right:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <strong>Amount Chargeable (in words)</strong>
                                </td>

                                <td style="
                                    width:40%;
                                    text-align:right;
                                    vertical-align:top;
                                    border-top:0.6px solid #777;
                                    border-right:0.6px solid #777;
                                    border-left:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <em>E. &amp; O.E</em>
                                </td>
                            </tr>

                            <!-- ROW 2 (NO BOTTOM BORDER HERE) -->
                            <tr>
                                <td style="
                                    vertical-align:top;
                                    border-left:0.6px solid #777;
                                    border-right:none;
                                    border-top:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <strong>
<t t-esc="o.currency_id.symbol"/>
<t t-esc="o.currency_id.amount_to_text(o.amount_total).replace('Rupees','').strip()"/> Only
</strong>

                                </td>

                                <td style="
                                    border-right:0.6px solid #777;
                                    border-left:none;
                                    border-top:none;
                                    border-bottom:none;
                                "></td>
                            </tr>


                            <tr>
                                <td style="border-left:0.6px solid #777; height:40px;"></td>
                                <td style="border-right:0.6px solid #777; height:40px;"></td>
                            </tr>
                            

                            <!-- ROW 3 : SIGNATURE (PROVIDES FINAL BOTTOM BORDER) -->
                            <tr>
                                <td style="
                                    border-left:0.6px solid #777;
                                    border-top:none;
                                    border-right:none;
                                    border-bottom:none;
                                "></td>
                                <td class="cell" style="text-align:right; vertical-align:bottom; height:10px;">
                                    <strong>for Duisport Packing Logistics India Pvt. Ltd.</strong><br/><br/><br/>
                                    Authorised Signatory
                                </td>
                            </tr>
                            <!-- OUTER BOTTOM BORDER (FULL WIDTH) -->
                            <tr>
                                <td colspan="2" style="
                                    border-left:0.6px solid #777;
                                    border-right:0.6px solid #777;
                                    border-bottom:0.6px solid #777;
                                    padding:0;
                                    height:0;
                                "></td>
                            </tr>


                        </table>
                        <!-- COMPUTER GENERATED NOTE (CENTERED) -->
                        <tr>
                            <td colspan="2" style="
                                border-left:0.6px solid #777;
                                border-right:0.6px solid #777;
                                border-top:none;
                                border-bottom:0.6px solid #777;
                                padding:8px;
                            ">
                                <div style="
                                    width:100%;
                                    text-align:center;
                                    font-size:13px;
                                    color:#555;
                                ">
                                    This is a Computer Generated Document
                                </div>
                            </td>
                        </tr>





                    </div>
                 
                </div>


              


            </t>


            <!-- ================= ANNEX-1 PAGE ================= -->
            <div style="page-break-before: always; font-size:13px;">

                <!-- <div style="text-align:center; font-weight:bold; font-size:16px; margin-bottom:20px;">
                    Annex-1<br/>
                    COMMERCIAL TERMS AND CONDITIONS
                </div> -->

                <div style="border:0.6px solid #777; padding:12px; min-height:250mm;">
                    <t t-if="o.commercial_terms">
                        <t t-raw="o.commercial_terms"/>
                    </t>
                    <t t-else="">
                        <p>No Commercial Terms &amp; Conditions defined.</p>
                    </t>
                </div>

            </div>




        </t>
    </template>

    <!-- REPORT ACTION -->
    <record id="action_report_purchase_order_custom" model="ir.actions.report">
        <field name="name">Purchase Order Report</field>
        <field name="model">purchase.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">all_reports_full.report_purchase_order_custom</field>
        <field name="report_file">all_reports_full.report_purchase_order_custom</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_type">report</field>
    </record>

</odoo>
