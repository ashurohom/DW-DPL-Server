<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_purchase_order_custom">
        <t t-call="web.html_container">

            <style>
                @page {
                    size: A4;
                    margin: 5mm;
                }
                .cell {
                    border: 0.6px solid #777;
                    padding: 6px;
                    vertical-align: top;
                    font-size: 16px;
                }

                .item-cell {
                    border-left: 0.6px solid #777;
                    border-right: 0.6px solid #777;
                    border-top: 0;
                    border-bottom: 0;
                    padding: 6px;
                }


                body {
                        font-size: 16px;
                    }


                .center {
                    text-align: center;
                }
            </style>

            <t t-foreach="docs" t-as="o">

                <div style="position: relative; width:100%; height:287mm;">

                    <!-- HEADING -->
                    <div style="text-align:center;font-weight:bold;font-size:16px;margin-bottom:6mm;">
                        PURCHASE ORDER
                    </div>

                    <!-- PAGE BORDER -->
                    <div style="
                        position:absolute;
                        top:12mm; left:0; right:0; bottom:0;
                        border:0.7px solid #4c4b4b;
                        padding:6mm;
                        box-sizing:border-box;
                    ">

                        <!-- MASTER TABLE -->
                        <table style="width:100%; border-collapse:collapse;">

                            <!-- ================= MASTER ROW 1 ================= -->
                            <tr>

                                <!-- LEFT : INVOICE TO -->
                                <td class="cell" style="width:60%;">
                                    <table style="width:100%; border-collapse:collapse;">
                                        <tr>
                                            <td style="width:18%;">
                                                <img t-if="o.company_id.logo"
                                                     t-att-src="image_data_uri(o.company_id.logo)"
                                                     style="max-height:60px;"/>
                                            </td>
                                            <td style="width:82%; padding-left:6px;">
                                                <strong>Invoice To</strong><br/>
                                                <strong t-esc="o.company_id.name"/><br/>
                                                <span t-esc="o.company_id.street"/><br/>
                                                <span t-esc="o.company_id.city"/> -
                                                <span t-esc="o.company_id.zip"/><br/>
                                                GSTIN/UIN :
                                                <span t-esc="o.company_id.vat"/><br/>
                                                State Name :
                                                <span t-esc="o.company_id.state_id.name"/>
                                            </td>
                                        </tr>
                                    </table>
                                </td>

                                <!-- RIGHT : HEADER GRID -->
                                <td class="cell" style="width:40%; padding:0;">
                                    <table style="width:100%; border-collapse:collapse;">

                                        <tr>
                                            <td class="cell">
                                                Voucher No.<br/>
                                                <strong t-esc="o.name"/>
                                            </td>
                                            <td class="cell">
                                                Dated<br/>
                                                <strong t-esc="o.date_order.strftime('%d-%b-%Y')"/>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td class="cell"></td>
                                            <td class="cell">
                                                Mode / Terms of Payment<br/>
                                                <strong t-esc="o.payment_term_id.name"/>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td class="cell">
                                                Reference No. &amp; Date<br/>
                                                <strong t-esc="o.name"/>
                                            </td>
                                            <td class="cell">
                                                Other References
                                            </td>
                                        </tr>

                                        <tr>
                                            <td class="item-cell center">
                                                Dispatched through <br/>
                                            </td>
                                            <td class="item-cell center">
                                                Destination <br/>
                                            </td>
                                        </tr>

                                    </table>
                                </td>
                            </tr>

                            <!-- ================= MASTER ROW 2 ================= -->
                            <tr>

                                <!-- LEFT : CONSIGNEE -->
                                <td class="cell">
                                    <strong>Consignee (Ship to)</strong><br/>
                                    <strong t-esc="o.dest_address_id.name"/><br/>
                                    <span t-esc="o.dest_address_id.street"/><br/>
                                    GSTIN/UIN :
                                    <span t-esc="o.dest_address_id.vat"/><br/>
                                    State Name :
                                    <span t-esc="o.dest_address_id.state_id.name"/>
                                </td>

                                <!-- RIGHT : TERMS (ROWSPAN STARTS HERE) -->
                                <td class="cell" rowspan="2">
                                    Terms of Delivery<br/>
                                    <strong>Door Delivery</strong>
                                </td>
                            </tr>

                            <!-- ================= MASTER ROW 3 ================= -->
                            <tr>

                                <!-- LEFT : SUPPLIER -->
                                <td class="cell">
                                    <strong>Supplier (Bill from)</strong><br/>
                                    <strong t-esc="o.partner_id.name"/><br/>
                                    <span t-esc="o.partner_id.street"/><br/>
                                    GSTIN/UIN :
                                    <span t-esc="o.partner_id.vat"/><br/>
                                    State Name :
                                    <span t-esc="o.partner_id.state_id.name"/>
                                </td>

                            </tr>

                        </table>

                        <!-- ================= ITEMS TABLE ================= -->
                        <table style="width:100%; border-collapse:collapse; margin-top:0;">

                            <!-- HEADER -->
                            <tr>
                                <th class="cell center" style="width:5%;">Sl<br/>No.</th>
                                <th class="cell" style="width:45%;">Description of Goods</th>
                                <th class="cell center" style="width:12%;">Due on</th>
                                <th class="cell center" style="width:12%;">Quantity</th>
                                <th class="cell center" style="width:10%;">Rate</th>
                                <th class="cell center" style="width:6%;">per</th>
                                <th class="cell center" style="width:10%;">Amount</th>
                            </tr>

                            <!-- ROWS -->
                            <t t-set="slno" t-value="1"/>
                            <t t-foreach="o.order_line" t-as="line">
                                <tr>
                                    <!-- SL NO -->
                                    <td class="cell center">
                                        <t t-esc="slno"/>
                                        <t t-set="slno" t-value="slno + 1"/>
                                    </td>

                                    <!-- DESCRIPTION -->
                                    <td class="cell">
                                        <strong t-esc="line.name"/>
                                    </td>

                                    <!-- DUE DATE -->
                                    <td class="cell center">
                                        <t t-if="o.date_planned">
                                            <t t-esc="o.date_planned.strftime('%d-%b-%y')"/>
                                        </t>
                                    </td>

                                    <!-- QTY -->
                                    <td class="cell" style="text-align:right;">
                                        <strong>
                                            <t t-esc="line.product_qty"/>
                                        </strong>
                                        Nos.
                                    </td>

                                    <!-- RATE -->
                                    <td class="cell" style="text-align:right;">
                                        <t t-esc="line.price_unit"/>
                                    </td>

                                    <!-- PER -->
                                    <td class="cell center">
                                        Nos.
                                    </td>

                                    <!-- AMOUNT -->
                                    <td class="cell" style="text-align:right;">
                                        <t t-esc="line.price_subtotal"/>
                                    </td>
                                </tr>
                            </t>

                            <tr>
                                <td class="cell" style="height:180px;"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                            </tr>


                            <!-- TOTAL ROW -->
                            <tr>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;"><strong>Total</strong></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>
                                        <t t-esc="sum(o.order_line.mapped('product_qty'))"/> Nos.
                                    </strong>
                                </td>
                                <td class="cell"></td>
                                <td class="cell"></td>
                                <td class="cell" style="text-align:right;">
                                    <strong>
                                        â‚¹ <t t-esc="o.amount_total"/>
                                    </strong><br/>
                                    <!-- <span style="font-style:italic;">E. &amp; O.E</span> -->
                                </td>
                            </tr>


                        </table>


                        <!-- AMOUNT IN WORDS + E.&O.E + SIGNATURE (OUTER BORDER MATCHES SIGNATURE BOTTOM) -->
                        <table style="width:100%; border-collapse:collapse; margin-top:0;">

                            <!-- ROW 1 -->
                            <tr>
                                <td style="
                                    width:60%;
                                    vertical-align:top;
                                    border-top:0.6px solid #777;
                                    border-left:0.6px solid #777;
                                    border-right:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <strong>Amount Chargeable (in words)</strong>
                                </td>

                                <td style="
                                    width:40%;
                                    text-align:right;
                                    vertical-align:top;
                                    border-top:0.6px solid #777;
                                    border-right:0.6px solid #777;
                                    border-left:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <em>E. &amp; O.E</em>
                                </td>
                            </tr>

                            <!-- ROW 2 (NO BOTTOM BORDER HERE) -->
                            <tr>
                                <td style="
                                    vertical-align:top;
                                    border-left:0.6px solid #777;
                                    border-right:none;
                                    border-top:none;
                                    border-bottom:none;
                                    padding:6px;
                                ">
                                    <strong>
                                        INR <t t-esc="o.currency_id.amount_to_text(o.amount_total)"/> Only
                                    </strong>
                                </td>

                                <td style="
                                    border-right:0.6px solid #777;
                                    border-left:none;
                                    border-top:none;
                                    border-bottom:none;
                                "></td>
                            </tr>

                            <!-- ROW 3 : SIGNATURE (PROVIDES FINAL BOTTOM BORDER) -->
                            <tr>
                                <td style="
                                    border-left:0.6px solid #777;
                                    border-top:none;
                                    border-right:none;
                                    border-bottom:none;
                                "></td>
                                <td class="cell" style="text-align:center; vertical-align:bottom; height:90px;">
                                    <strong>for Duisport Packing Logistics India Pvt. Ltd.</strong><br/><br/>
                                    Authorised Signatory
                                </td>
                            </tr>
                            <!-- OUTER BOTTOM BORDER (FULL WIDTH) -->
                            <tr>
                                <td colspan="2" style="
                                    border-left:0.6px solid #777;
                                    border-right:0.6px solid #777;
                                    border-bottom:0.6px solid #777;
                                    padding:0;
                                    height:0;
                                "></td>
                            </tr>


                        </table>

                    </div>
                 
                </div>


                <!-- FOOTER BELOW PAGE BORDER -->
                <div style="
                    text-align:center;
                    color:#555;
                    margin-top:-2mm;
                ">
                    This is a Computer Generated Document
                </div>


            </t>
        </t>
    </template>

    <!-- REPORT ACTION -->
    <record id="action_report_purchase_order_custom" model="ir.actions.report">
        <field name="name">Purchase Order Report</field>
        <field name="model">purchase.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">all_reports_full.report_purchase_order_custom</field>
        <field name="report_file">all_reports_full.report_purchase_order_custom</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_type">report</field>
    </record>

</odoo>
