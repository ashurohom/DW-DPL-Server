<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_wip_valuation_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <html>
                        <head>
                            <meta charset="utf-8"/>
                            <style>
                                body { font-family: Arial, sans-serif; font-size: 12px; margin: 0; padding: 20px; }
                                .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
                                .company-header { font-size: 20px; font-weight: bold; }
                                .report-title { font-size: 16px; margin: 10px 0; }
                                .report-info { font-size: 12px; margin: 5px 0; }
                                table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                                th { background-color: #f2f2f2; padding: 8px; text-align: left; border: 1px solid #ddd; font-weight: bold; }
                                td { padding: 8px; border: 1px solid #ddd; }
                                .text-right { text-align: right; }
                                .text-center { text-align: center; }
                                .footer { margin-top: 30px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 10px; color: #666; }
                                .summary-box { background-color: #f9f9f9; padding: 15px; border: 1px solid #ddd; margin: 20px 0; }
                                .summary-title { font-weight: bold; margin-bottom: 10px; }
                                .no-data { text-align: center; padding: 40px; color: #666; font-style: italic; }
                            </style>
                        </head>
                        <body>
                            <!-- Header -->
                            <div class="header">
                                <div class="company-header">
                                    <t t-esc="company.name"/>
                                </div>
                                <div class="report-title">WORK IN PROGRESS (WIP) VALUATION REPORT</div>
                                <div class="report-info">
                                    <t t-if="start_date">
                                        <p>Period: <t t-esc="start_date"/> to <t t-esc="end_date"/></p>
                                    </t>
                                    <p>Generated on: <t t-esc="current_date"/></p>
                                </div>
                            </div>

                            <!-- Summary Box -->
                            <div class="summary-box">
                                <div class="summary-title">Report Summary</div>
                                <p>Total Items: <strong><t t-esc="len(lines)"/></strong></p>
                                <p>Total WIP Value: <strong><t t-esc="'%.2f' % total_wip_value"/></strong></p>
                            </div>

                            <!-- WIP Items Table -->
                            <t t-if="lines and len(lines) > 0">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>No.</th>
                                            <th>Date</th>
                                            <th>Product</th>
                                            <th>Reference</th>
                                            <th>Location</th>
                                            <th class="text-right">Quantity</th>
                                            <th class="text-right">Value</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="lines" t-as="line">
                                            <t t-set="index" t-value="line_index + 1"/>
                                            <tr>
                                                <td class="text-center"><t t-esc="index"/></td>
                                                <td><t t-esc="line.get('date', '')"/></td>
                                                <td><t t-esc="line.get('product', '')"/></td>
                                                <td><t t-esc="line.get('mo_reference', line.get('reference', ''))"/></td>
                                                <td><t t-esc="line.get('location', '')"/></td>
                                                <td class="text-right"><t t-esc="'%.2f' % line.get('qty', 0)"/></td>
                                                <td class="text-right"><t t-esc="'%.2f' % line.get('value', 0)"/></td>
                                            </tr>
                                        </t>
                                        <tr style="font-weight: bold; background-color: #f0f0f0;">
                                            <td colspan="6" class="text-right">TOTAL WIP VALUE:</td>
                                            <td class="text-right">
                                                <t t-esc="'%.2f' % total_wip_value"/>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </t>
                            <t t-else="">
                                <div class="no-data">
                                    <h3>No WIP Data Found</h3>
                                    <p>No work in progress items were found in the selected period.</p>
                                    <p>This could be because:</p>
                                    <ul style="text-align: left; display: inline-block;">
                                        <li>No manufacturing orders exist in the date range</li>
                                        <li>No stock moves to/from production locations</li>
                                        <li>All manufacturing orders are in draft or cancelled state</li>
                                    </ul>
                                </div>
                            </t>

                            <!-- Footer -->
                            <div class="footer">
                                <p>Generated by <t t-esc="company.name"/> | Page 1</p>
                            </div>
                        </body>
                    </html>
                </t>
            </t>
        </template>
    </data>
</odoo>